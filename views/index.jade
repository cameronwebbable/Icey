script(type='text/html', id='modal').
   <div class="modal" id="start-modal">
     <div class="modal-header">
       <h3>Your Github account</h3>
     </div>
     <div class="modal-body">
       <form>
        <label for="username">GitHub username</label>
        <input name="username" id="username" type="text" class="span6" placeholder="Your GitHub username"></input>
        <label for="apikey">GitHub API key</label>
        <input name="apikey" id="apikey" type="text" class="span6" placeholder="Your GitHub API key"></input>
        </form>
     </div>
     <div class="modal-footer">
       <a href="#" class="btn btn-primary" id="start-btn">Go git it</a>
     </div>
   </div>
   
 script(type='text/html', id='projectselect').
    <div class="modal" id="project-modal">
      <div class="modal-header">
        <img class="gravatar" src="http://www.gravatar.com/avatar/{{infoobj.gravatar_id}}" />
        <h3 class="gravatar">Hey, {{infoobj.name}}</h3>
        <div class="clearfix"></div>
      </div>
      <div class="modal-body">
        <form>
         <input type="hidden" id="username" name="username" value="{{infoobj.login}}" />
         <input type="hidden" id="key" name="key" value="" />
         <label for="username">Select a project</label>
         <select id="project-select">
          {{#repos}}
          <option value="{{name}}">{{name}}</option>
          {{/repos}}
         </select>
      </div>
      <div class="modal-footer">
         <a href="#" class="btn btn-primary" id="go-btn">Git er done</a>
       </div>
    </div>

script
  // when the dom's ready
    $(document).ready(function () {
      
      $.backstretch('/images/bg.jpeg')
      
      var startmodal;
      startmodal = ich.modal();
      $('body').append(startmodal);
      $('#start-modal').modal('show', {backdrop: false});
      $('#start-btn').click(function(e) {
        e.preventDefault();
        $.post('/authenticate', {
          username: $('#username').val(),
          apikey: $('#apikey').val()
        },
        function(r) {
          if (r) {
            $('#start-modal').modal('hide');
            var selectormodal;
            selectormodal = ich.projectselect(r);
            $('body').append(selectormodal);
            $('#key').attr('value', $('#apikey').val());
            $('#project-modal').modal('show');
          }
        });
      });
      
      $('#go-btn').live('click', function(e) {
        e.preventDefault();
        window.location.href = '/project/'+$('#username').val()+'/'+$('#project-select').find('option:selected').text()+'/'+$('#key').val();
        $('#project-modal').modal('hide');
      });
      
      
    });
